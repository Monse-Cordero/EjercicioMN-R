---
title: "9.5 Métodos de eliminación directa"
author: "Monserrath Antonio Cordero"
date: "2025-10-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
### 9.5.1. Gaussiana Simple

```{r gauss_simple, echo=FALSE}
gauss_simple <- function(A, b, tolerancia, verbose = FALSE) {
  if (!is.matrix(A)) stop("A debe ser una matriz.")
  if (!is.numeric(b)) stop("b debe ser numérico.")
  n <- nrow(A)
  if (ncol(A) != n) stop("A debe ser cuadrada.")
  if (length(b) != n) stop("Longitud de b debe ser igual al número de filas de A.")
  Ab <- cbind(A, b);
  numcols = ncol(Ab)
  for (k in 1:(n - 1)) {
    pivote <- Ab[k, k]
    if (abs(pivote) < tolerancia) {
      stop(sprintf("Pivote casi cero en fila %d (%.3e). El método sin pivoteo falla.", k, pivote))
    }
    if (k + 1 <= n) {
      for (i in (k + 1):n) {
        m <- Ab[i, k] / pivote;
        Ab[i, k:numcols] <- Ab[i, k:numcols] - m * Ab[k, k:numcols]
        if (abs(Ab[i, k]) < tolerancia) Ab[i, k] <- 0
        if (verbose) {
          cat(sprintf("k=%d, i=%d, m=%.6g\n", k, i, m));
          print(Ab)
        }
      }
    }
  }
  x <- numeric(n)
  for (i in n:1) {
    if (i == n) {
      suma <- 0
    } else {
      suma <- sum(Ab[i, (i + 1):n] * x[(i + 1):n])
    }
    x[i] <- (Ab[i, n + 1] - suma) / Ab[i, i]
  }
  list(x = x, U = Ab[, 1:n], Ab = Ab)
}

```

```{r}
A <- matrix(c(
  2, 1, -1,
  -3, -1, 2,
  -2, 1, 2
), nrow = 3, byrow = TRUE)
b <- c(8, -11, -3)
tolerancia <- 1e-12
res <- gauss_simple(A, b, tolerancia, verbose = TRUE)
res$x
res$U
res$Ab
A %*% res$x

```

 