---
title: "Tarea 7.6: Resolución de Sistemas por Gauss-Seidel"
author: "Monserrath Antonio Cordero"
date: "2025-10-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
gauss_seidel <- function(A, b, x0 = rep(0, length(b)), tol = 1e-6, max.iter = 5) {
  n <- length(b)
  x <- x0
  cat("Iteración |", paste0("x", 1:n, collapse = "     "), "\n")
  cat("--------------------------------------\n")
  
  for (k in 1:max.iter) {
    x_old <- x
    for (i in 1:n) {
      s1 <- if (i > 1) sum(A[i, 1:(i - 1)] * x[1:(i - 1)]) else 0
      s2 <- if (i < n) sum(A[i, (i + 1):n] * x_old[(i + 1):n]) else 0
      x[i] <- (b[i] - s1 - s2) / A[i, i]
    }
    
    # Imprimir con 2 cifras significativas
    cat(sprintf("%5d     |", k), 
        paste(formatC(x, digits = 2, format = "fg", flag = "#"), collapse = "   "), "\n")
    
    # Verificar convergencia
    if (sqrt(sum((x - x_old)^2)) < tol) {
      cat("✅ Convergió en", k, "iteraciones\n\n")
      return(x)
    }
  }
  cat("No convergió después de", max.iter, "iteraciones\n\n")
  return(x)
}


```

# --- Ejercicio 1 ---

```{r}
A1 <- matrix(c(3, -0.2, -0.5,
               0.1, 7, 0.4,
               0.4, -0.1, 10), nrow = 3, byrow = TRUE)
b1 <- c(8, -19.5, 72.4)
gauss_seidel(A1, b1)

```

# --- Ejercicio 2 ---

```{r}
A2 <- matrix(c(-5, 1.4, -2.7,
               0.7, -2.5, 15,
               3.3, -11, 4.4), nrow = 3, byrow = TRUE)
b2 <- c(94.2, -6, -27.5)
gauss_seidel(A2, b2)


```

# --- Ejercicio 3 ---

```{r}
A3 <- matrix(c(3, -0.5, 0.6,
               0.3, -4, -1,
               -0.7, 2, 7), nrow = 3, byrow = TRUE)
b3 <- c(5.24, -0.387, 14.803)
gauss_seidel(A3, b3)


```

# --- Ejercicio 4 ---

```{r}
A4 <- matrix(c(5, -0.2, 1,
               0.1, 3, -0.5,
               -0.3, 1, -7), nrow = 3, byrow = TRUE)
b4 <- c(1.5, -2.7, 9.5)
gauss_seidel(A4, b4)

```

# --- Ejercicio 6 ---

```{r}
A6 <- matrix(c(0.15, 2.11, 30.75,
               0.64, 1.21, 2.05,
               3.21, 1.53, 1.04), nrow = 3, byrow = TRUE)
b6 <- c(-26.38, 1.01, 5.23)
gauss_seidel(A6, b6)

```

# --- Ejercicio 9 ---

```{r}
A9 <- matrix(c(3, -0.1, -0.2,
               0.1, 7, -0.3,
               0.3, -0.2, 10), nrow = 3, byrow = TRUE)
b9 <- c(7.85, -19.3, 71.4)
gauss_seidel(A9, b9)

```

# --- Ejercicio 10 ---

```{r}
A10 <- matrix(c(17, -2, -3,
                -5, 21, -2,
                -5, -5, 22), nrow = 3, byrow = TRUE)
b10 <- c(500, 200, 30)
gauss_seidel(A10, b10)

```
